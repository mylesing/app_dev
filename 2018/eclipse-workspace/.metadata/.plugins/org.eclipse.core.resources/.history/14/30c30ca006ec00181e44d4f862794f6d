import java.util.LinkedList;

import java.util.List;
import java.util.Map;

import org.junit.jupiter.api.Test;

import org.apache.poi.openxml4j.exceptions.InvalidFormatException;
import org.apache.poi.ss.usermodel.*;
import java.io.File;
import java.io.IOException;
import java.util.Iterator;


class SimpleRankTest {

	@Test
	void SimpleRankRunTest() throws IOException, InvalidFormatException {
		double[] rankValues;
		String path = "D:/work 2018/data files for testing";
		String dataFile = "/Depression RAW DATA.xlsx";
		String casesFile = "/MaxDiff Data FINAL 9.5.18 - RAW DIRECT EXPORT ALL CASES.xlsx";
		Workbook databook = WorkbookFactory.create(new File(path + dataFile));
		Workbook casebook = WorkbookFactory.create(new File(path + casesFile));
		/*
		SimpleAttribute attrA = new SimpleAttribute("A", "QualityA");
		SimpleAttribute attrB = new SimpleAttribute("B", "QualityB");
		SimpleAttribute attrC = new SimpleAttribute("C", "QualityC");
		SimpleAttribute attrD = new SimpleAttribute("D", "QualityD");
		SimpleAttribute attrE = new SimpleAttribute("E", "QualityE");
		SimpleAttribute attrF = new SimpleAttribute("F", "QualityF");
		SimpleAttribute attrG = new SimpleAttribute("G", "QualityG");
		List<SimpleAttribute> attrList = new LinkedList<SimpleAttribute>();
		attrList.add(attrA);
		attrList.add(attrB);
		attrList.add(attrC);
		attrList.add(attrD);
		attrList.add(attrE);
		attrList.add(attrF);
		attrList.add(attrG);

		rankValues = new double[attrList.size()];
		SimpleRank rank = new SimpleRank(attrList, 3);
		if (rank.runDynamic() == 0) {
			rankValues = SpectralRank.doSpectralRank(attrList);
			for(int i = 0; i < attrList.size(); i++) {
				System.out.println(attrList.get(i).getName() + ": "  + rankValues[i] * 200.0 + " " + attrList.get(i).getTally());
				System.out.println(attrList.get(i).getList());
			}
		}
		double[][] m_decision = new double[4][9];
		m_decision[0] = new double[] {2.0, 1500, 20000, 5.5, 5, 9, 0.1};
		m_decision[1] = new double[] {2.5, 2700, 18000, 8.5, 3, 5, 0.2};
		m_decision[2] = new double[] {1.8, 2000, 21000, 4.5, 7, 7, 0.4};
		m_decision[3] = new double[] {2.2, 1800, 20000, 7.5, 5, 5, 0.3};
		TOPSIS topsis = new TOPSIS(m_decision, rankValues);
		for(Map.Entry<Double, Integer> entry : topsis.getRankings().entrySet()) {
			System.out.println("Closeness: " + entry.getKey() + "   Item: " + entry.getValue());
		}
	*/
	}
	
	/**
	 * SimpleAttribute attrA = new SimpleAttribute("A", "QualityA");
		SimpleAttribute attrB = new SimpleAttribute("B", "QualityB");
		SimpleAttribute attrC = new SimpleAttribute("C", "QualityC");
		SimpleAttribute attrD = new SimpleAttribute("D", "QualityD");
		SimpleAttribute attrE = new SimpleAttribute("E", "QualityE");
		SimpleAttribute attrF = new SimpleAttribute("F", "QualityF");
		SimpleAttribute attrG = new SimpleAttribute("G", "QualityG");
		SimpleAttribute attrH = new SimpleAttribute("H", "QualityG");
		SimpleAttribute attrI = new SimpleAttribute("I", "QualityG");
		SimpleAttribute attrJ = new SimpleAttribute("J", "QualityG");
		SimpleAttribute attrK = new SimpleAttribute("K", "QualityG");
		SimpleAttribute attrL = new SimpleAttribute("L", "QualityG");
		SimpleAttribute attrM = new SimpleAttribute("M", "QualityG");
		SimpleAttribute attrN = new SimpleAttribute("N", "QualityG");
		SimpleAttribute attrO = new SimpleAttribute("O", "QualityG");
		SimpleAttribute attrP = new SimpleAttribute("P", "QualityG");
		List<SimpleAttribute> attrList = new LinkedList<SimpleAttribute>();
		attrList.add(attrA);
		attrList.add(attrB);
		attrList.add(attrC);
		attrList.add(attrD);
		attrList.add(attrE);
		attrList.add(attrF);
		attrList.add(attrG);
		attrList.add(attrH);
		attrList.add(attrI);
		attrList.add(attrJ);
		attrList.add(attrK);
		attrList.add(attrL);
		attrList.add(attrM);
		attrList.add(attrN);
		attrList.add(attrO);
		attrList.add(attrP);
	 */
}
